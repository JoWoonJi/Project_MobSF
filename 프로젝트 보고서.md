# 2ì°¨ í”„ë¡œì íŠ¸ ë³´ê³ ì„œ

# 1. ê¸°íš

## í”„ë¡œì íŠ¸ ëª…: ëª¨ë°”ì¼ ìƒŒë“œë°•ìŠ¤ êµ¬ì¶•

## íŒ€ëª…: í•´ì»¤ì¡ì¡°

### 1.1 íŒ€ êµ¬ì„±ì› ë° ë‹´ë‹¹ ì—…ë¬´

|  ì´ë¦„ | ì—­í•  | ë‹´ë‹¹ ì—…ë¬´ |
| --- | --- | --- |
| ê³µí†µì§„í–‰ |  | MobSF í™˜ê²½ êµ¬ì¶• ë° ë¶„ì„ |
| í™ì˜ì°½ | íŒ€ì¥ | jadx ì½”ë“œ ë¶„ì„ ë° ë…¸ì…˜ ì •ë¦¬, ë³´ê³ ì„œ ì‘ì„± |
| êµ¬í˜„ëª¨ | íŒ€ì› | ë¶„ì„ ë° í…ŒìŠ¤íŠ¸ |
| ê¹€ë™ì§„ | íŒ€ì› | ë¶„ì„ ë° í…ŒìŠ¤íŠ¸ |
| ì¥ë‹¤ì†œ | íŒ€ì› | ë³´ê³ ì„œ ì‘ì„± |
| ì¡°ìš´ì§€ | íŒ€ì› | ì •ì ë¶„ì„, ë™ì ë¶„ì„ ìë™í™” ì½”ë”© |
| ìµœìŠ¹í¬ | íŒ€ì› | ì •ì ë¶„ì„ ìë™í™” |

### 1.2 í”„ë¡œì íŠ¸ ëª©ì  ë° í•„ìš”ì„±

ì´ í”„ë¡œì íŠ¸ì˜ ì£¼ëœ ëª©ì ì€ ëª¨ë°”ì¼ ì•…ì„±ì½”ë“œë¥¼ ë¶„ì„í•˜ê³  ì´í•´í•œ ê³¼ì •ì„ í† ëŒ€ë¡œ MobSFì™€ Fridaì™€ ê°™ì€ ì˜¤í”ˆì†ŒìŠ¤ ë„êµ¬ë¥¼ í™œìš©í•˜ì—¬ ì •ì /ë™ì ë¶„ì„ ì „ ìë™í™” êµ¬ì¶•ì´ë‹¤. ì´ë¥¼ í†µí•´ ì–»ëŠ” ì¥ì ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
ì²«ë²ˆì§¸, ì•ˆë“œë¡œì´ë“œ ì•±ì— ëŒ€í•œ ì•„í‚¤í…ì²˜ë¥¼ ì´í•´í•˜ì—¬ ëª¨ë°”ì¼ ì•…ì„±ì½”ë“œì˜ í˜•ì„± ê³¼ì •ì„ íŒŒì•…í•˜ê³ , ì•±ì˜ ë¦¬ì†ŒìŠ¤ íŒŒì¼ê³¼ ì†ŒìŠ¤ ì½”ë“œë¥¼ ë¶„ì„í•˜ì—¬ ë³´ì•ˆ ì·¨ì•½ì ì„ ì‹ë³„í•  ìˆ˜ ìˆë‹¤.
ë‘ë²ˆì§¸ MobSFì™€ Emulatorë¥¼ í†µí•´ ì •ì /ë™ì ë¶„ì„ê³¼ì •ì„ ê²½í—˜í•˜ì—¬ íŒŒì¼ ë‚´ ì•…ì„±í–‰ìœ„ì— ëŒ€í•œ ì´í•´ë¥¼ ë†’ì´ê³  Frida ì˜¤í”ˆì†ŒìŠ¤ ë„êµ¬ë¥¼ ì´ìš©í•˜ì—¬ ìš°íšŒ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ì—¬ ë³´ì•ˆ íƒì§€ ìš°íšŒì— ëŒ€í•œ ì´í•´ë¥¼ ë†’ì¼ ìˆ˜ ìˆë‹¤.
ë§ˆì§€ë§‰ìœ¼ë¡œ íŒŒì•…í•œ ì•…ì„±ì½”ë“œ ìƒ˜í”Œì„ MobSF API ì»¤ìŠ¤í„°ë§ˆì´ì§•ì„ í†µí•œ ì •ì ë¶„ì„ê³¼ ë™ì ë¶„ì„ ìë™í™”ë¥¼ ì§„í–‰í•˜ì—¬ ì•±ì˜ ë”ìš± ì‹ ì†í•˜ê³  íš¨ìœ¨ì ì¸ ë³´ì•ˆ í‰ê°€ê°€ ì´ë£¨ì–´ì§ˆ ìˆ˜ ìˆì–´ ë³´ì•ˆ ê²€ì‚¬ í”„ë¡œì„¸ìŠ¤ì˜ ë¹ ë¥¸ ì§„í–‰ì„ ê°€ëŠ¥í•˜ê²Œ í•œë‹¤.

# 2. ë‚´ìš©

## 2.1 ëª¨ë°”ì¼ ìƒŒë“œë°•ìŠ¤ êµ¬ì¶• í”„ë¡œì íŠ¸ ì¼ì •

[WBS_í•´ì»¤ì¡ì¡° (ìë™ ì €ì¥ë¨).xlsx](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/WBS_%25ED%2595%25B4%25EC%25BB%25A4%25EC%259E%25A1%25EC%25A1%25B0_(%25EC%259E%2590%25EB%258F%2599_%25EC%25A0%2580%25EC%259E%25A5%25EB%2590%25A8).xlsx)

![Untitled](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled.png)

## 2.2 ë‹¨ê³„ ë³„ í”„ë¡œì„¸ìŠ¤

| ì¼ì • | ì‹¤í–‰ ë‚´ìš© |
| --- | --- |
| 1ì£¼ì°¨ | MobSF í™˜ê²½ êµ¬ì¶• ë° í”„ë¡œì íŠ¸ íŒŒì•… |
| [Day 01] | í”„ë¡œì íŠ¸ ê³„íš ìˆ˜ë¦½ |
| 24.02.19  | ìƒŒë“œë°•ìŠ¤ êµ¬ì¶•ì— ëŒ€í•œ ì •ì˜ ë° í”„ë¡œì íŠ¸ ì´í•´í•˜ê¸° |
| [Day 02-03] | MobSF ì‹¤í–‰ í™˜ê²½ êµ¬ì¶• ë° ì‹¤í–‰ |
| 24.02.20~21 | https://www.notion.so/5b2997b48b704e5dbbe31db0916bd98c?pvs=21 ì°¸ê³ í•´ì„œ MobSF ì„¤ì¹˜ì§„í–‰ |
|  | ì•ˆë“œë¡œì´ë“œ ìŠ¤íŠœë””ì˜¤ ì—°ë™ ì˜¤ë¥˜ë¡œ ì§€ë‹ˆëª¨ì…˜ìœ¼ë¡œ ì—°ë™ ì„±ê³µ |
|  | ê°€ìƒí™˜ê²½êµ¬ì¶• ì˜¤ë¥˜ ë°œìƒìœ¼ë¡œ í¬ê¸° â†’ ë¡œì»¬ í˜¸ìŠ¤íŠ¸ í™˜ê²½ì—ì„œ ëª¨ë‘ ì§„í–‰ (ìŠ¹í¬ë‹˜, í˜„ëª¨ë‹˜ ì œì™¸) |
|  | MobSF ì •ì , ë™ì ë¶„ì„ í™˜ê²½ êµ¬ì¶• ë° ì‹¤í–‰ |
| [Day 04-07] | MobSF êµ¬ì¡° ì´í•´ ë° jadxë¥¼ í†µí•œ sample.apk ì •ì  ë¶„ì„ ì‹¤ìŠµ |
| 24.02.22~25 | MobSF ì •ì , ë™ì ë¶„ì„ ë™ì‘ ê³¼ì • íŒŒì•… |
|  | jadx ë„êµ¬ë¥¼ ì´ìš©í•´ sample.apk ì •ì  ë¶„ì„ ì‹¤ìŠµ |
|  | dexíŒŒì¼ ì •ì ë¶„ì„ì„ í†µí•œ Nested APK í˜¸ì¶œê´€ê³„ íŒŒì•… |
|  |  |
| 2ì£¼ì°¨ | MobSF ìë™í™”ë¥¼ ìœ„í•œ ì•…ì„±ì½”ë“œ ì•± ë‚´ë¶€ ì½”ë“œ ë¶„ì„ ë° ìˆ˜ë™ ì‹¤ìŠµ |
| [Day 08-11] | sample.apk ë””ë²„ê¹…&ë¦¬íŒ¨í‚¤ì§• |
| 24.02.26~29 | ì•ˆë“œë¡œì´ë“œ ì•± êµ¬ì¡° íŒŒì•… ê³µë¶€ |
|  | jadxë¡œ ì•”í˜¸í™”ëœ kill íŒŒì¼ ì•ˆì—´ë¦¼ / ë³µí˜¸í™” í•„ìš” > https://gchq.github.io/CyberChef/#recipe=AES_Decrypt(%7B'option':'UTF8','string':'dbcdcfghijklmaop'%7D,%7B'option':'Hex','string':''%7D,'ECB','Raw','Raw',%7B'option':'Hex','string':''%7D,%7B'option':'Hex','string':''%7D) |
|  | apktoolì„ ì´ìš©í•˜ì—¬ sample.apkì˜ kill-classes.dexë¥¼ ë³µí˜¸í™”í•˜ê³  ë¦¬íŒ¨í‚¤ì§• |
|  | nested apk(pgsHZz.apk)ì„ ë³µí˜¸í™”í•˜ê³  ë¦¬íŒ¨í‚¤ì§• |
|  | keytool, jarsignerë„êµ¬ë¥¼ ì´ìš©í•œ keystore íŒŒì¼ ìƒì„±, ë° ì„œëª… |
|  | ì„œëª…í•œ sample.apk ì—ë®¬ë ˆì´í„°ì—  ì„¤ì¹˜ ì„±ê³µ |
| [Day 10-13] | frida ìš°íšŒ |
| 24.02.28~03.02 | frida server/client ì„¤ì¹˜ í›„ ì—ë®¬ë ˆì´í„° ì—°ë™ |
|  | anti-vmì„ ìš°íšŒí•˜ê¸° ìœ„í•œ ì½”ë“œë¥¼ íŒŒì•… ë° frida ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„± |
|  | frida ìš°íšŒ ìŠ¤í¬ë¦½íŠ¸ ì£¼ì…í•œ í›„ ì•± ë™ì‘ ê³¼ì • íŒŒì•… (ê¶Œí•œì„¤ì • ë“± |
|  | MobSF ìë™í™”ë¥¼ ìœ„í•œ ì†ŒìŠ¤ì½”ë“œ êµ¬ì¡° íŒŒì•… ë° api êµ¬ì¡° ê³µë¶€ |
|  |  |
| 3ì£¼ì°¨ | MobSF APIë¥¼ ì´ìš©í•œ ìƒŒë“œë°•ìŠ¤ ë¶„ì„ ì‹œìŠ¤í…œ ìë™í™” |
| [Day 14-16]  | MobSF API ì •ì  ë¶„ì„ ìë™í™” |
| 24.03.04~03.06 | MobSF APIë¥¼ ì´ìš©í•œ ì •ì  ë¶„ì„ ìë™í™” |
|  | ì •ì  ë¶„ì„ ìë™í™” ë¶„ì„ ì‹¤í–‰ ì„±ê³µ ë° report ë‹¤ìš´ ì„±ê³µ |
| [Day 15-17]  | MobSF API ë™ì  ë¶„ì„ ìë™í™” |
| 24.03.05~03.07 | frida ìš°íšŒ ì‹¤í–‰ ì‹¤íŒ¨ > ì„±ê³µ (kill-dex ì›ë³¸ íŒŒì¼ ì‚´ë¦¬ê¸°) |
|  | ì•¡í‹°ë¹„í‹°ë³„ ë™ì ë¶„ì„ êµ¬í˜„ ì„±ê³µ |
|  | ê¶Œí•œ ì„¤ì • ìë™í™” ì„±ê³µ |
|  | tls /ssl í…ŒìŠ¤íŠ¸ |
| [Day 15-19]  | ìë™í™” í”„ë¡œê·¸ë¨ í…ŒìŠ¤íŠ¸ |
| 24.03.07 | ì˜¤ë¥˜ ìˆ˜ì •  ë° ì—…ë°ì´íŠ¸ (ë‚´ë¶€ Nested APKì— ëŒ€í•œ ë³´ê³ ì„œ ì¶”ì¶œ ê¸°ëŠ¥ ì¶”ê°€) |
|  | í…ŒìŠ¤íŠ¸ ì™„ë£Œ ë° ì‹œì—° ì˜ìƒ ì´¬ì˜ ì™„ë£Œ |
| [Day 19-21]  | í”„ë¡œì íŠ¸ ê²°ê³¼ ì ê²€ ë° ë³´ê³ ì„œ ì‘ì„± ë§ˆë¬´ë¦¬  |
| 24.03.08 | ê°œì¸ë³„ ë³´ê³ ì„œ ì‘ì„± ë§ˆë¬´ë¦¬ ë° ê°œì¸ë³„ ëŠë‚€ì  ì‘ì„± |
|  | ì˜ì°½ë‹˜ - ë³´ê³ ì„œ ì ê²€ ë° ë°œí‘œ ì¤€ë¹„ |
| 24.03.09 | ìë™í™” API íŠ¸ëŸ¬ë¸” ìŠˆíŒ… ë° ë§ˆë¬´ë¦¬ |
| 24.03.10 | ìš´ì§€ë‹˜ - + virustotalAPI ì•…ì„±ì½”ë“œ íŒ¨ë°€ë¦¬ ì‹ë³„  |
|  | ìŠ¹í¬ë‹˜ - mobsfAPI , get_apps, mobsfy ì¶”ê°€/ ë³µí˜¸í™” ê³¼ì • ìˆ˜ì • / ssl/tls ì¶”ê°€ |
| [Day 22]  | ì œì¶œ ë° ë°œí‘œ |
| 24.03.11 | ì˜ì°½ë‹˜ - ì œì¶œ ë° ë°œí‘œ |

## 2.3 ì‹œìŠ¤í…œ í™˜ê²½

- windows10 , 11
- python version : 3.11.7
    - íŒŒì´ì¬ë²„ì „ì´ ì—¬ëŸ¬ì¢…ë¥˜ê°€ ìˆìœ¼ë©´ ì¸ì‹ì„ í•˜ì§€ëª»í•´ì„œ MobSFì‹¤í–‰ ë¶ˆê°€ëŠ¥
    - ìš´ì§€ë‹˜, ë™ì§„ë‹˜ run.bat ì˜¤ë¥˜ë¡œ ì¸í•œ 3.11.5 íŒŒì´ì¬ ë²„ì „ ë‹¤ìš´ê·¸ë ˆì´ë“œ
- android-studio-2023.1.1.28-windows
- genymotion-3.6.0
    - Samsung Galaxy S10, API25 - 7.1, 540X960, 240HDPI
- Win64 openSSL v3.2.1 version
- jdk-11.0.20
- wkhtmltox-0.12.6-1.msvc2015-win64
- ë¶„ì„ í”„ë¡œê·¸ë¨
    - Mobile-Security-Framework-MobSF-master
    - jadx-gui-1.4.7
    

## 2.4 dexíŒŒì¼ ë³µí˜¸í™” ë° ë¦¬íŒ¨í‚¤ì§•

<aside>
ğŸ’¡ MobSFì˜ ì •ì ë¶„ì„ ê¸°ëŠ¥ì„ ì´ìš©í•´ì„œ sample.apkë¥¼ ë¶„ì„í•˜ë ¤ í•˜ëŠ”ë° apkì•ˆì— ì•”í˜¸í™”ëœ dex íŒŒì¼ë“¤ì´ ìˆì–´ ì•”í˜¸í™”ëœ dexíŒŒì¼ë“¤(kill-classes.dex)ì´ ì •ì ë¶„ì„ì— ì•ˆë‚˜ì˜¨ë‹¤. ì´ë¥¼ ë‚˜ì˜¤ê²Œë” í•´ê²°í•´ì•¼ í•œë‹¤.

</aside>

### sample.apk ë¦¬íŒ¨í‚¤ì§•í•˜ê¸°

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%201.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%201.png)

`sample.apk` íŒŒì¼ ì•ˆì— 1. `classes.dex` ì •ìƒíŒŒì¼ 2. `kill-classes.dex` ì•”í˜¸í™”ëœ íŒŒì¼ ì´ë ‡ê²Œ 2ê°€ì§€ê°€ ìˆë‹¤.

ì´ ìƒíƒœì—ì„œ MobSFì—ë‹¤ê°€ íŒŒì¼ ì—…ë¡œë“œë¥¼ í•˜ê²Œ ë˜ë©´

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%202.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%202.png)

kill-classes.dex íŒŒì¼ì€ ì•ˆë³´ì¸ë‹¤. ì•”í˜¸í™”ë˜ì–´ ìˆì–´ì„œ ì •ìƒíŒŒì¼ë°–ì— ì•ˆë³´ì¸ë‹¤.

ê·¸ëŸ¬ë©´ ì•…ì„± dexíŒŒì¼ì„ ì–´ë–»ê²Œ í™•ì¸í•  ìˆ˜ ìˆëƒ? â†’ apktoolë¡œ ë³µí˜¸í™” ë¦¬íŒ¨í‚¤ì§• í•˜ì—¬ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

[[Mobile] Windows Apktool ì„¤ì¹˜](https://cgy12306.tistory.com/393)

â‡’ apktool ì„¤ì¹˜ ë°©ë²• ë¸”ë¡œê·¸ ì„¤ëª…

[Install Guide | Apktool](https://apktool.org/docs/install/)

â‡’apktool ì„¤ì¹˜ í™ˆí˜ì´ì§€

apktoolì„ ì‚¬ìš©í•˜ì—¬ `sample.apk` íŒŒì¼ì„ ë””ì»´íŒŒì¼ í›„ ë¦¬íŒ¨í‚¤ì§• í•´ì•¼ëœë‹¤.

## sample.apk (unpack1) ë³µí˜¸í™”

`apktool d -s sample.apk -o unpack`

- **`d`**: apktoolì˜ ë””ì½”ë“œ(ë””ì»´íŒŒì¼) ëª…ë ¹ì–´ì…ë‹ˆë‹¤. APK íŒŒì¼ì„ ë””ì½”ë”©í•˜ì—¬ ì›ì‹œ ë¦¬ì†ŒìŠ¤ ë° ì†ŒìŠ¤ ì½”ë“œë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤.
- **`s`**: ì´ ì˜µì…˜ì€ apktoolì´ ë¦¬ì†ŒìŠ¤ë¥¼ ë””ì½”ë“œí•˜ëŠ” ë° ì‚¬ìš©í•˜ëŠ” íŠ¹ì • ì„¤ì •ì„ ì§€ì •í•©ë‹ˆë‹¤. **`s`** ì˜µì…˜ì„ ì‚¬ìš©í•˜ë©´ íŠ¹ì • ë¦¬ì†ŒìŠ¤ IDê°€ ë³€í•˜ì§€ ì•Šê³  ìœ ì§€ë˜ë„ë¡ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **`o unpack`**: ë””ì½”ë”©ëœ íŒŒì¼ì„ ì¶œë ¥í•  ë””ë ‰í† ë¦¬ë¥¼ ì§€ì •í•©ë‹ˆë‹¤. ì—¬ê¸°ì„œ **`unpack`*ëŠ” ë””ì½”ë”©ëœ íŒŒì¼ì´ ì €ì¥ë  í´ë” ì´ë¦„ì…ë‹ˆë‹¤. í•„ìš”ì— ë”°ë¼ ì´ ì´ë¦„ì„ ì›í•˜ëŠ” ê²ƒìœ¼ë¡œ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ìœ„ ëª…ë ¹ì–´ë¥¼ ì´ìš©í•˜ì—¬ ë””ì»´íŒŒì¼í•œë‹¤.

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%203.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%203.png)

unpack í´ë”ì— ì••ì¶•ì´ í’€ë ¸ë‹¤.

ì´ ìƒíƒœì—ì„œ `kill-classes.dex`íŒŒì¼ì„ [cyber cheif](https://gchq.github.io/CyberChef/#recipe=AES_Decrypt(%7B'option':'UTF8','string':'dbcdcfghijklmaop'%7D,%7B'option':'Hex','string':''%7D,'ECB','Raw','Raw',%7B'option':'Hex','string':''%7D,%7B'option':'Hex','string':''%7D))ì— ì˜¬ë ¤ì¤˜ì„œ ë³µí˜¸í™”í•œë‹¤.

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%204.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%204.png)

outputë³´ë©´ ì²« ì‹œê·¸ë‹ˆì²˜ê°€ dexë¡œ ì‹œì‘í•˜ì£ ? ì´ëŸ¬ë©´ ì œëŒ€ë¡œ ë³µí˜¸í™” ëœê²ë‹ˆë‹¤. â†’ classes2.dex ì´ë¦„ìœ¼ë¡œ íŒŒì¼ì„ unpack í´ë”ì— ì €ì¥í•œë‹¤.

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%205.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%205.png)

ì•”í˜¸í™”ëœ `kill-classes.dex` íŒŒì¼ì„ ì§€ìš°ê³  ë³µí˜¸í™”ëœ classe2.dexë¡œ ëŒ€ì²´í•œë‹¤.

## pgsHZz.apk (unpack2) ë³µí˜¸í™” ë° ë””ì»´íŒŒì¼ í›„ ë¦¬íŒ¨í‚¤ì§•

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%206.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%206.png)

ê·¸ ë‹¤ìŒ ë¦¬íŒ¨í‚¤ì§• í•˜ë©´ ë˜ëŠ”ë° ë¬¸ì œëŠ” assets í´ë” ì•ˆì— `pgsHZz.apk` íŒŒì¼ì´ í•˜ë‚˜ ë” ìˆê³  ì•ˆì˜ êµ¬ì¡°ë¥¼ ë³´ë©´ `kill-classes.dex` , `kill-classe2s.dex` ì•”í˜¸í™”ëœ íŒŒì¼ë“¤ì´ ë˜ ìˆë‹¤. ì´ íŒŒì¼ë“¤ë„ ë³µí˜¸í™” í•´ì¤˜ì•¼ëœë‹¤.

`apktool b [ë””ì»´íŒŒì¼ëœ í´ë”] -o [ìµœì¢…APKíŒŒì¼ì´ë¦„]`

`apktool d -s pgsHZz.apk -o unpack2`

ìœ„ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ ë””ì»´íŒŒì¼í•˜ê³  ê°ê° íŒŒì¼ë“¤ì„ ë˜‘ê°™ì€ í‚¤ë¡œ ë³µí˜¸í™”í•˜ê³  ëŒ€ì²´í•œë‹¤.

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%207.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%207.png)

ëŒ€ì²´ ì„±ê³µ!

ì—¬ê¸°ì„œ í—·ê°ˆë¦¬ë©´ ì•ˆë˜ëŠ”ë°

`apktool b unpack2 -o pgsHZz.apk`

ì´ì œ ë‹¤ì‹œ `pgsHZz.apk` ë¡œ ë¦¬íŒ¨í‚¤ì§• í•˜ê¸° ìœ„í•´ ìœ„ì˜ ëª…ë ¹ì–´ë¥¼  ì‚¬ìš©í•œë‹¤.

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%208.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%208.png)

ë¦¬íŒ¨í‚¤ì§• ì„±ê³µ! ì´ì œ ë³µí˜¸í™” íŒŒì¼ë“¤ë¡œ ëŒ€ì²´í•˜ê³  ë¦¬íŒ¨í‚¤ì§•ëœ `pgsHZz.apk` íŒŒì¼ì„ `sample.apk\\assets` ê²½ë¡œì— ì›ë˜ `pgsHZz.apk` íŒŒì¼ì„ ì‚­ì œí•˜ê³  ëŒ€ì²´í•œë‹¤.

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%209.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%209.png)

ì›ë˜íŒŒì¼ ì§€ìš°ê³ ..

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2010.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2010.png)

ëŒ€ì²´ ì„±ê³µ!

## sample.apk (unpack1) ë””ì»´íŒŒì¼ í›„ ë¦¬íŒ¨í‚¤ì§•

ì´ì œ ì•ˆì˜ `pgsHZz.apk` íŒŒì¼ ì•ˆì˜ dexíŒŒì¼ë“¤ì€ ë‹¤ ë³µí˜¸í™” ëœê²ƒë“¤ì´ë‹ˆ í•œêº¼ë²ˆì— ë¦¬íŒ¨í‚¤ì§•ì„ í•´ì¤€ë‹¤.(ì›ë˜ í•œ ì•±ì— Nestedëœ ì–´í”Œë“¤ì´ë¯€ë¡œ!)

ì´ì œ unpackì— ë‹¤ ëª¨ì˜€ìœ¼ë¯€ë¡œ ë¦¬íŒ¨í‚¤ì§• í•  ê²ƒì´ë‹¤.

apktool b [ë””ì»´íŒŒì¼ëœ í´ë”] -o [ìµœì¢…APKíŒŒì¼ì´ë¦„]

`apktool b unpack -o sample2.apk`

ìœ„ ëª…ë ¹ì–´ë¡œ ë¦¬íŒ¨í‚¤ì§• í•´ì¤€ë‹¤.

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2011.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2011.png)

ë¦¬íŒ¨í‚¤ì§• ì„±ê³µ! ì´ì œ MobSFì— ì˜¬ë ¤ì„œ ì •ì ë¶„ì„ í•´ë³´ì

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2012.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2012.png)

5ê°œì˜ dexíŒŒì¼ë“¤ì´ MobSFì— ì •ì ë¶„ì„ ê¸°ëŠ¥ì„ í†µí•´ ë‚˜ì˜¤ê²Œ ëœë‹¤. (ì›ë˜ëŠ” ì•”í˜¸í™” ì•ˆëœ 2ê°œ íŒŒì¼ë§Œ ë‚˜ì™”ì—ˆë‹¤.)

ëª©í‘œ ë‹¬ì„± ì„±ê³µ!

## 2.5 ë¦¬íŒ¨í‚¤ì§•í•œ apkíŒŒì¼ ì„œëª… í›„ ì—ë®¬ë ˆì´í„° ì„¤ì¹˜

<aside>
ğŸ’¡ apkíŒŒì¼ì„ ë¦¬íŒ¨í‚¤ì§•í•˜ëŠ”ê²ƒ ë¿ ì•„ë‹ˆë¼ ì´ì œ ëª¨ë°”ì¼ ë‹¨ë§ê¸°ì— ì„¤ì¹˜í•´ì„œ ì‚¬ìš©í•´ë³´ê¸° ìœ„í•´ì„œëŠ” APK Signing ì‘ì—…ë„ í•´ì¤˜ì•¼ í•œë‹¤.

</aside>

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2013.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2013.png)

ë¦¬íŒ¨í‚¤ì§•í•œ sample2.apkë¥¼ ì§€ë‹ˆëª¨ì…˜ì— ì˜®ê¸°ë ¤ë‹ˆê¹Œ ìœ„ì™€ê°™ì€ ì—ëŸ¬ê°€ ëœ¬ë‹¤. ì¬ì„œëª… ì•ˆí•´ì„œ ëœ¨ëŠ” ì˜¤ë¥˜ë¼ê³  í•œë‹¤.

ê·¸ë ‡ë‹¤ ì–´í”Œì€ ì„œëª…ì„ í•´ì•¼ ë¬´ê²°ì„±ì´ ë³´ì¥ë˜ê³  ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì–´í”Œì´ì–´ì•¼ ë‹¤ìš´ë°›ì„ ìˆ˜ ìˆë‹¤.

- ì•±ì„ ì„œëª…í•˜ëŠ” ì´ìœ 
    1. **ì•±ì˜ ì‹ ì› í™•ì¸**: ì„œëª…ì€ ì•±ì´ ê°œë°œëœ ê°œë°œìë‚˜ ê°œë°œíŒ€ì„ í™•ì¸í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. ì•±ì´ ê³µì‹ì ìœ¼ë¡œ ì¶œì‹œëœ ê²ƒì´ í™•ì¸ë˜ë©´ ì‚¬ìš©ìë“¤ì€ ì•±ì„ ë” ì‹ ë¢°í•˜ê²Œ ë©ë‹ˆë‹¤.
    2. **ì•±ì˜ ë¬´ê²°ì„± ë³´ì¥**: ì„œëª…ì„ í†µí•´ ì•±ì´ ë³€ê²½ë˜ì§€ ì•Šì•˜ìŒì„ ê²€ì¦í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¦‰, ì•±ì˜ ë‚´ìš©ì´ ê°œë°œìê°€ ì œê³µí•œ ê²ƒê³¼ ë™ì¼í•œì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    3. **ì•±ì˜ ë³´ì•ˆ ê°•í™”**: ì„œëª…ëœ ì•±ì€ ë¸”ë™í•´í‚¹, ë°ì´í„° ë³€ì¡° ë˜ëŠ” ì•…ì„± ì½”ë“œ ì‚½ì…ê³¼ ê°™ì€ ë³´ì•ˆ ìœ„í˜‘ìœ¼ë¡œë¶€í„° ë”ìš± ì•ˆì „í•©ë‹ˆë‹¤.
    4. **í”Œë«í¼ ë˜ëŠ” ìŠ¤í† ì–´ ìš”êµ¬ ì‚¬í•­**: íŠ¹ì • í”Œë«í¼ì´ë‚˜ ì•± ìŠ¤í† ì–´ëŠ” ì„œëª…ëœ ì•±ë§Œì„ í—ˆìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì„œëª…ëœ ì•±ì€ ì´ëŸ¬í•œ ìš”êµ¬ ì‚¬í•­ì„ ì¶©ì¡±ì‹œí‚¤ê¸° ìœ„í•´ í•„ìš”í•©ë‹ˆë‹¤.

### **APK Signing í•´ì£¼ê¸°**

APK Signing í•˜ê¸° ìœ„í•´ì„œ ì‚¬ìš©í•˜ëŠ” keystore ê°€ ì—†ë‹¤ë©´ ë¯¸ë¦¬ ë§Œë“¤ì–´ì¤˜ì•¼ í•œë‹¤. ë¨¼ì € keystore ì„œëª…ì„ ë§Œë“¤ê¸° ìœ„í•´ì„œëŠ” ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì´ìš©í•œë‹¤.

`keytool -genkey -v -keystore [keystoreì´ë¦„] -alias [aliasì´ë¦„] -keyalg [í‚¤ì•Œê³ ë¦¬ì¦˜] -keysize [í‚¤ì‚¬ì´ì¦ˆ]keytool -genkey -v -keystore honghong.keystore -alias honghong -keyalg RSA -keysize 2048`

```jsx
>keytool -genkey -v -keystore honghong.keystore -alias honghong-keyalg RSA -keysize 2048
í‚¤ ì €ì¥ì†Œ ë¹„ë°€ë²ˆí˜¸ ì…ë ¥:
ìƒˆ ë¹„ë°€ë²ˆí˜¸ ë‹¤ì‹œ ì…ë ¥:
ì´ë¦„ê³¼ ì„±ì„ ì…ë ¥í•˜ì‹­ì‹œì˜¤.
  [Unknown]:  honghong
ì¡°ì§ ë‹¨ìœ„ ì´ë¦„ì„ ì…ë ¥í•˜ì‹­ì‹œì˜¤.
  [Unknown]:  honghong
ì¡°ì§ ì´ë¦„ì„ ì…ë ¥í•˜ì‹­ì‹œì˜¤.
  [Unknown]:  honghong
êµ¬/êµ°/ì‹œ ì´ë¦„ì„ ì…ë ¥í•˜ì‹­ì‹œì˜¤?
  [Unknown]:  Seoul
ì‹œ/ë„ ì´ë¦„ì„ ì…ë ¥í•˜ì‹­ì‹œì˜¤.
  [Unknown]:  Seoul
ì´ ì¡°ì§ì˜ ë‘ ìë¦¬ êµ­ê°€ ì½”ë“œë¥¼ ì…ë ¥í•˜ì‹­ì‹œì˜¤.
  [Unknown]:  KO
CN=honghong, OU=honghong, O=honghong, L=Seoul, ST=Seoul, C=KOì´(ê°€) ë§ìŠµë‹ˆê¹Œ?
  [ì•„ë‹ˆì˜¤]:  y

ë‹¤ìŒì— ëŒ€í•´ ìœ íš¨ ê¸°ê°„ì´ 90ì¼ì¸ 2,048ë¹„íŠ¸ RSA í‚¤ ìŒ ë° ìì²´ ì„œëª…ëœ ì¸ì¦ì„œ(SHA256withRSA)ë¥¼ ìƒì„±í•˜ëŠ” ì¤‘
        : CN=honghong, OU=honghong, O=honghong, L=Seoul, ST=Seoul, C=KO
<honghong>ì— ëŒ€í•œ í‚¤ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì‹­ì‹œì˜¤.
        (í‚¤ ì €ì¥ì†Œ ë¹„ë°€ë²ˆí˜¸ì™€ ë™ì¼í•œ ê²½ìš° Enter í‚¤ë¥¼ ëˆ„ë¦„):
ìƒˆ ë¹„ë°€ë²ˆí˜¸ ë‹¤ì‹œ ì…ë ¥:
[honghong.keystoreì„(ë¥¼) ì €ì¥í•˜ëŠ” ì¤‘]

```

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2014.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2014.png)

ë“±ë¡ì ˆì°¨ê°€ ëë‚˜ë©´ keystoreê°€ ì €ì¥ë˜ì—ˆë‹¤ê³  ë‚˜ì˜¤ê³  ìœ„ì— keystoreê°€ ìƒê¸´ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

### **APK íŒŒì¼ì— ì„œëª…í•˜ê¸°(self-sign)**

ì´ë²ˆì—ëŠ” jarsigner ë¼ëŠ” ë„êµ¬ë¥¼ ì´ìš©í•´ì„œ APK íŒŒì¼ì— ì„œëª…ì„ í•œë‹¤.

ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ë©´ ëœë‹¤.

`jarsigner -verbose -sigalg [ì„œëª…ì•Œê³ ë¦¬ì¦˜] -digestalg [digestì•Œê³ ë¦¬ì¦˜] -keystore [keystoreíŒŒì¼] [ì„œëª…í• APK] [aliasëª…]`

`jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore honghong.keystore sample2.apk honghong`

```jsx
...ì¤‘ëµ...
	signing: res/layout/select_dialog_item_material.xml
  signing: res/layout/select_dialog_multichoice_material.xml
  signing: res/layout/select_dialog_singlechoice_material.xml
  signing: res/layout/support_simple_spinner_dropdown_item.xml
  signing: res/layout-v26/abc_screen_toolbar.xml
  signing: res/layout-watch/abc_alert_dialog_button_bar_material.xml
  signing: res/layout-watch/abc_alert_dialog_title_material.xml
  signing: res/menu/activity_main_drawer.xml
  signing: res/menu/main.xml
  signing: res/xml/accessibilityservice.xml
  signing: res/xml/file_paths.xml
  signing: resources.arsc
  signing: assets/pgsHZz.apk
  signing: error_prone/Annotations.gwt.xml
  signing: jsr305_annotations/Jsr305_annotations.gwt.xml
  signing: third_party/java_src/error_prone/project/annotations/Annotations.gwt.xml
  signing: third_party/java_src/error_prone/project/annotations/Google_internal.gwt.xml

>>> Signer
    X.509, CN=honghong, OU=honghong, O=honghong, L=Seoul, ST=Seoul, C=KO
    [
    Signature algorithm: SHA256withRSA, 2048-bit key
    [trusted certificate]

jar signed.

Warning:
The signer's certificate is self-signed.
The SHA1 algorithm specified for the -digestalg option is considered a security risk and is disabled.
The SHA1withRSA algorithm specified for the -sigalg option is considered a security risk and is disabled.

```

ì²˜ìŒì—” keystore ì„œëª… íŒŒì¼ì— ëŒ€í•œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ë¼ê³  ë‚˜ì˜¨ë‹¤.

ì…ë ¥í•˜ê³  ë‚˜ë©´ ë­”ê°€ ì­‰ ë‚˜ì˜¤ë©´ì„œ ê²°êµ­ ë§ˆì§€ë§‰ì—” `jar signed` ë¼ê³  ë‚˜ì˜¤ë©´ ì„œëª…ì´ ì •ìƒì ìœ¼ë¡œ ì™„ë£Œëœ ê²ƒì´ë‹¤.

### ì—ë®¬ë ˆì´í„°ì— sample2.apk ì„¤ì¹˜í•´ë³´ê¸°

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2015.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2015.png)

ì„œëª…ì™„ë£Œí•œ sample2.apkíŒŒì¼ì„ ì§€ë‹ˆëª¨ì…˜ ì—ë®¬ë ˆì´í„°ì— ì˜®ê¸°ë‹ˆê¹Œ ì˜ ì„¤ì¹˜ëœ ëª¨ìŠµë‹ˆë‹¤.

adb ëª…ë ¹ì–´ë¥¼ í†µí•´ ì„¤ì¹˜í•˜ëŠ” ë²•

`adb install [ë¦¬íŒ¨í‚¤ì§•í•œAPKíŒŒì¼]`

## 2.6 jadxë¶„ì„ ë° Frida ìš°íšŒScript ë§Œë“¤ê¸°

### MobSF ì •ì  ë³´ê³ ì„œ ì´ìš©í•´ Anti-VM code ì°¾ê¸°

<aside>
ğŸ’¡ ìš°ì„  Fridaë¡œ ìš°íšŒí•˜ëŠ” ì´ìœ ëŠ” sample.apkë¥¼ ì‹¤í–‰í•˜ë©´ VM(ì§€ë‹ˆëª¨ì…˜ê°™ì€ ì—ë®¬ë ˆì´í„° ë“±)ì„ íƒì§€í•˜ëŠ” ì½”ë“œê°€ ìˆê¸° ë•Œë¬¸ì— ê°€ìƒí™˜ê²½ ì•ˆì—ì„œ ì–´í”Œ ì‹¤í–‰ì´ ì•ˆëœë‹¤. 
ê·¸ëŸ¬ë¯€ë¡œ Fridaë¥¼ ì´ìš©í•´ scriptë¥¼ ì¸ì ì…˜í•˜ì—¬ ìš°íšŒí•˜ê³  ì–´í”Œ ì‹¤í–‰ì— ì„±ê³µì‹œí‚¤ê¸° ìœ„í•¨ì— ëª©ì ì´ ìˆë‹¤.

</aside>

[re_sample_report.pdf](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/re_sample_report.pdf)

MobSFì—ì„œì˜ sample_repacked.apk ì •ì  ë¶„ì„ ë³´ê³ ì„œ

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2016.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2016.png)

`sample.apk`ì¸ ì›ë³¸íŒŒì¼ì„ ë¶„ì„í•˜ë©´ Anti-VM ì½”ë“œê°€ ì•ˆë‚˜ì˜¤ì§€ë§Œ ë³µí˜¸í™”í›„ ë¦¬íŒ¨í‚¤ì§• ê³¼ì •ì„ ê±°ì¹œ

`sample_repacked.apk`ì—ì„œëŠ” `classes2.dex`ì—ì„œ Anti-VM ì½”ë“œê°€ ë¶„ì„ë³´ê³ ì„œë¥¼ í†µí•´ ë‚˜ì˜¨ë‹¤.

- **Build.MODEL check**: ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤í–‰ ì¤‘ì¸ ë””ë°”ì´ìŠ¤ì˜ ëª¨ë¸ëª…ì„ í™•ì¸í•˜ëŠ” ì½”ë“œê°€ í¬í•¨ë˜ì–´ ìˆìŒì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ê°€ìƒ ë¨¸ì‹ ì„ ì‚¬ìš©í•  ê²½ìš° íŠ¹ì • ëª¨ë¸ëª…ì´ ì„¤ì •ë˜ì§€ ì•Šê±°ë‚˜ ì˜ˆìƒì¹˜ ëª»í•œ ê°’ì„ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **Build.TAGS check**: ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤í–‰ ì¤‘ì¸ ë””ë°”ì´ìŠ¤ì˜ ë¹Œë“œ íƒœê·¸ë¥¼ í™•ì¸í•˜ëŠ” ì½”ë“œê°€ í¬í•¨ë˜ì–´ ìˆìŒì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ê°€ìƒ ë¨¸ì‹ ì—ì„œì˜ ë¹Œë“œ íƒœê·¸ëŠ” ì¢…ì¢… "test-keys"ì™€ ê°™ì€ íŠ¹ì • ê°’ë“¤ì„ í¬í•¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**Build.TAGS**

com > ldjSxw > heBbQd > p017a > C0740b

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2017.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2017.png)

### jadxë„êµ¬ë¥¼ í†µí•œ classes2.dex íŒŒì¼ ë¶„ì„ ê³¼ì •

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2018.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2018.png)

VMì„ íƒì§€í•˜ëŠ” ì½”ë“œ ë¶„ì„ì„ ìœ„í•´ sample.apkì—ì„œ kill-classes.dex íŒŒì¼ì„ ë³µí˜¸í™”í•œ classes2.dexíŒŒì¼ì„ jadxë¡œ ë¶„ì„í•œë‹¤. (classes.dex íŒŒì¼ì—ëŠ” VM íƒì§€ ì½”ë“œê°€ ì—†ìŒì„ í™•ì¸í•¨)

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2019.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2019.png)

ìœ„ì˜ `b` í´ë˜ìŠ¤ì—ì„œ vmì„ ìš°íšŒí•˜ëŠ” í•¨ìˆ˜ë“¤ì´ ë“¤ì–´ìˆë‹¤. ì´ ì½”ë“œë“¤ì„ ë³´ë©´ì„œ Fridaìš°íšŒscript ì½”ë“œë¥¼ ì§œì•¼í•œë‹¤.

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2020.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2020.png)

ì½”ë“œë¥¼ ì•Œì•„ë³´ê¸° ì‰½ê²Œ ë‚œë…í™” ë„êµ¬ë¥¼ ì´ìš©í•œë‹¤. b í´ë˜ìŠ¤ â†’ C0740b

**ì½”ë“œ ë‚œë…í™”**

ì½”ë“œ ë‚œë…í™”ëŠ” ì´ 3ê°€ì§€ê°€ ìˆë‹¤.

1. ê¸°ë³¸ì ìœ¼ë¡œ ë³€ìˆ˜ ì´ë¦„ì´ë‚˜ í•¨ìˆ˜ ì´ë¦„ì„ ë‚œë…í™” â† sample.apkëŠ” ì´ê²ƒë§Œ í•´ë‹¹!
2. ë¬¸ìì—´ì„ ë‚œë…í™” ì‹œí‚¤ëŠ” ë°©ë²•
    1. ì˜ˆì œë¥¼ ë³´ë©´ ë¬¸ìì—´ì€ ì½ì„ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë¬¸ìì—´ ë‚œë…í™”ëŠ” ê±¸ë ¤ìˆì§€ ì•Šë‹¤.
3. ì½”ë“œë¥¼ ê°€ìƒí™” ì‹œí‚¤ëŠ” ë°©ë²•
    1. ì½”ë“œ ê°€ìƒí™”ê°€ ê±¸ë ¤ìˆìœ¼ë©´ ì†ŒìŠ¤ì½”ë“œë¥¼ ë³¼ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ì½”ë“œ ê°€ìƒí™”ë„ ê±¸ë ¤ìˆì§€ ì•Šë‹¤.
    

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2021.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2021.png)

a, b ê°™ì´ ì½ê¸° ë˜ëŠ” ì‹ë³„í•˜ê¸° ì–´ë ¤ìš´ ë³€ìˆ˜ëª…ë“¤ì´ ìˆë‹¤. ì´ ì‚¬ëŒë“¤ì´ ì‹¤ì œë¡œ ê°œë°œí• ë•Œ ì´ëŸ° ë³€ìˆ˜ë¥¼ ì¼ì„ê¹Œ? â†’ ì•„ë‹ˆë‹¤.

í´ë˜ìŠ¤ ì´ë¦„, ë³€ìˆ˜ ì´ë¦„, í•¨ìˆ˜ ì´ë¦„ ì •ë„ëŠ” ë‚œë…í™” ì‹œì¼°êµ¬ë‚˜ ë¼ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.

ì´ê²ƒì„ **proguard**ë¼ê³  ë¶€ë¥¸ë‹¤. proguard ì‹¤í–‰ ì˜µì…˜ì— ë”°ë¼ì„œ ì¢€ ë‹¤ë¥´ê¸´í•œë° ì´ëŸ°ì‹ìœ¼ë¡œ ì½”ë“œ ë‚œë…í™”ë¥¼ ì‹œí‚¬ ìˆ˜ ìˆë‹¤.

### C0740b í´ë˜ìŠ¤ ì½”ë“œ ë¶„ì„í•˜ê¸° (ë‚œë…í™” ì§„í–‰)

[jadx.java](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/jadx.java)

<aside>
ğŸ’¡ ì´ ì½”ë“œì—ì„œ ì‚¬ìš©ë˜ëŠ” ì•ˆë“œë¡œì´ë“œ ë””ë°”ì´ìŠ¤ì˜ ìƒíƒœë¥¼ í™•ì¸í•˜ëŠ” ë©”ì„œë“œëŠ” ì´ 7ê°œì´ë‹¤.

VMíƒì§€ì— ì„±ê³µí•˜ë©´ Trueë¥¼ ë°˜í™˜í•œë‹¤. ì´ë¥¼ ìš°íšŒí•˜ë ¤ë©´ falseë¥¼ ë°˜í™˜í•´ì•¼ í•œë‹¤.

</aside>

### VMì„ ìš°íšŒí•˜ëŠ” 7ê°œ Detectioní•¨ìˆ˜ í™•ì¸

- BaseActivity class - `onCreate` method
    - BaseActivity: ëª¨ë“  Activityì˜ ë¶€ëª¨ í´ë˜ìŠ¤
    - BaseActivityë¥¼ ì‹œì‘í•˜ë©´ì„œ Detection íƒì§€ í›„, íƒì§€ëœ ì‚¬í•­ì´ ì¡´ì¬í•  ê²½ìš° ë£¨íŒ… ìƒíƒœë¡œ ì¸ì‹í•˜ê³  í”„ë¡œê·¸ë¨ ì¢…ë£Œ

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2022.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2022.png)

`com.ldjSxw.heBbQd.p017a.C0740b class` - `m47k` method

**1. Language**

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2023.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2023.png)

`m48j` method

- **ì‹œìŠ¤í…œ ì–¸ì–´**ê°€ í•œê¸€ì´ ì•„ë‹ ê²½ìš° íƒì§€ (True ë°˜í™˜)

**2. test-keys**

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2024.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2024.png)

`m43o` method - ë””ë°”ì´ìŠ¤ê°€ í…ŒìŠ¤íŠ¸ìš© í‚¤(test-keys)ë¥¼ ì‚¬ìš©í•˜ëŠ”ì§€ í™•ì¸

- BuildTagì— test-keysê°€ í¬í•¨ë˜ì–´ ìˆì„ ê²½ìš° íƒì§€ (True ë°˜í™˜)
- â€œtest-keyâ€ ë³´í†µ ê°œë°œìë²„ì „ì˜ ì•ˆë“œë¡œì´ë“œ ë¹Œë“œì—ì„œ ì‚¬ìš©ë¨

**3. Root**

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2025.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2025.png)

`m45m` method - ë””ë°”ì´ìŠ¤ì— Superuser ì•±ì´ ì„¤ì¹˜ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸

- Superuser.apk íŒŒì¼ ì„¤ì¹˜ë˜ì–´ ìˆì„ ê²½ìš° íƒì§€ (True ë°˜í™˜) (rooting ê´€ë ¨ íŒ¨í‚¤ì§€)

**4. Emulator**

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2026.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2026.png)

`m50h` method - ì—ë®¬ë ˆì´í„°ì¸ì§€ë¥¼ í™•ì¸

- /proc/tty/drivers íŒŒì¼ ë‚´ `goldfish`ë¼ëŠ” ê°’ì´ ìˆì„ ê²½ìš° íƒì§€ (True ë°˜í™˜)
- `goldfish` ë¬¸ìì—´ì€ ì•ˆë“œë¡œì´ë“œ ì—ë®¬ë ˆì´í„°ì˜ ì»¤ë„ ì´ë¦„

**5. ADB**

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2027.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2027.png)

`m51g` method - ë””ë°”ì´ìŠ¤ì˜ ADB(Android Debug Bridge)ê°€ í™œì„±í™”ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸

- adb í™œì„±í™” ì—¬ë¶€ í™•ì¸, í™œì„±í™” ì‹œ íƒì§€ (True ë°˜í™˜)
- ì•ˆë“œë¡œì´ë“œ ì‹œìŠ¤í…œ ì„¤ì •ì—ì„œ `adb_enabled`ê°’ì„ ê°€ì ¸ì™€ 1ì´ë©´ ADBê°€ í™œì„±í™”, 0ì´ë©´ ë¹„í™œì„±
ADBê°€ ë¹„í™œì„±í™” ë˜ì—ˆë‹¤ë©´ falseë¥¼ ë°˜í™˜

**6. VPN**

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2028.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2028.png)

`m41q` method - ë””ë°”ì´ìŠ¤ì— VPN(Virtual Private Network) ì—°ê²°ì´ í™œì„±í™”ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸

- `tun0` ë˜ëŠ” `ppp0` ì´ë¦„ì˜ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ê°€ ì‚¬ìš©ì¤‘ì¼ ê²½ìš° íƒì§€ (True ë°˜í™˜)

**7. Proxy**

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2029.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2029.png)

`m40r` method - ë””ë°”ì´ìŠ¤ì˜ í”„ë¡ì‹œ ì„¤ì • ì—¬ë¶€ë¥¼ í™•ì¸

- ë””ë°”ì´ìŠ¤ì— í”„ë¡ì‹œ ì„¤ì •ì´ êµ¬ì„±ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” í•¨ìˆ˜
- APIë²„ì „ì— ë”°ë¼ ë‹¤ë¥´ê²Œ ë™ì‘í•˜ë„ë¡ ì„¤ì •
- API 14ë¯¸ë§Œì—ì„œëŠ” Proxy í´ë˜ìŠ¤ì˜ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ í”„ë¡ì‹œ ì„¤ì •ì„ ê°€ì ¸ì˜´
- proxyAddress, proxyProt == -1ìœ¼ë¡œ ë˜ì–´ ìˆë‹¤ë©´ í”„ë¡ì‹œê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŒìœ¼ë¡œ íŒë‹¨
- ì´ì™¸ì˜ ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ í”„ë¡ì‹œê°€ ì„¤ì •ë˜ì§€ ì•ŠìŒìœ¼ë¡œ ì²˜ë¦¬

### ë¶„ì„í•œ ì½”ë“œë¥¼ ë°”íƒ•ìœ¼ë¡œ Frida ìš°íšŒ ì½”ë“œ ì‘ì„±

```jsx
Java.perform(function () {
    var TargetClass = Java.use('com.ldjSxw.heBbQd.a.b');
    TargetClass.k.implementation = function () {
        send("[+] Intercepted com.ldjSxw.heBbQd.a.b.k()");
        return false;
    };
});
```

íƒì§€ ì½”ë“œì˜ í˜¸ì¶œì„ í›„í‚¹í•˜ì—¬ í•­ìƒ `false`ë¥¼ ë¦¬í„´í•˜ê²Œ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±

## 2.7 Fridaì½”ë“œ ì£¼ì…ì„ í†µí•œ ìš°íšŒí•˜ê¸° ë° ì–´í”Œ ì‹¤í–‰

<aside>
ğŸ’¡ Fridaë„êµ¬ë¥¼ í†µí•´ ìš°íšŒë¥¼ í•˜ì§€ ì•Šìœ¼ë©´ `My Scan APP` ì–´í”Œì´ ì‹¤í–‰ì´ ì•ˆë˜ê³  êº¼ì§„ë‹¤. ê·¸ ì´ìœ ëŠ” `My Scan APP` ì•ˆì— VMì„ íƒì§€í•˜ëŠ” ì½”ë“œë“¤ì´ ë“¤ì–´ìˆê¸° ë•Œë¬¸ì´ë‹¤. (7ê°œ)

ë•Œë¬¸ì— `My Scan APP` ì•±ì´ ì‹¤í–‰ì´ ë˜ì–´ì•¼ ë™ì  ë¶„ì„ì´ ì§„í–‰ ê°€ëŠ¥í•˜ë¯€ë¡œ ìš°íšŒë¥¼ ìœ„í•´ Frida ë„êµ¬ë¥¼ ì´ìš©í•´ì„œ JavaScript ì½”ë“œë¥¼ ì‚½ì…í•´ì„œ ìš°íšŒí•œë‹¤.

</aside>

### Frida ì„¤ì¹˜ ê³¼ì •

**frida Client ì„¤ì¹˜**

```bash
$ pip3 install --upgrade pip
$ pip3 install frida-tools
```

**Frida Server ì„¤ì¹˜ ë° ì‹¤í–‰**

1. Frida Server ìµœì‹  release ë‹¤ìš´ë¡œë“œ: [https://github.com/frida/frida/releases](https://github.com/frida/frida/releases)
- ë””ë°”ì´ìŠ¤ ìš´ì˜ì²´ì œì— ë§ëŠ” ë²„ì „ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œ í•  ê²ƒ

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2030.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2030.png)

1. ì••ì¶• í•´ì œ í›„ adb ëª…ë ¹ì–´ë¥¼ ì´ìš©í•˜ì—¬ ë””ë°”ì´ìŠ¤ë¡œ í•´ë‹¹ íŒŒì¼ ì „ì†¡

```python
$ adb push frida-server-16.2.1-android-x86 /data/local/tmp/

```

1. adb shell ì ‘ì† í›„ ì „ì†¡í•œ frida server íŒŒì¼ ì‹¤í–‰

```python
cd /data/local/tmp/
chmod +x frida-server-16.2.1-android-x86
./frida-server-16.2.1-android-x86

./frida-server-16.2.1-android-x86 & #<= ì¶”ì²œ. ë°±ê·¸ë¼ìš´ë“œì‹¤í–‰(ì´í›„ ë™ì ë¶„ì„ìë™í™”ì‹œ í•„ìš”)

```

```python
#ì—°ê²° í”„ë¡œì„¸ìŠ¤ í™•ì¸
C:\\Users\\HP>frida-ps -U

```

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2031.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2031.png)

ì´ë ‡ê²Œ frida ì„œë²„ë¥¼ ì¼œë†“ê³ (ì‹¤í–‰ì¤‘ì´ì—¬ì•¼ í•¨) ë‹¤ë¥¸ cmdì°½ì„ ì¼œì„œ í´ë¼ë¥¼ ì‹¤í–‰í•œë‹¤.

$í•˜ë©´ ì¼œë†“ì§€ ì•Šì•„ë„ ëœë‹¤.

- `frida-ls-devices`: ì—°ê²° ê°€ëŠ¥í•œ ê¸°ê¸° ëª©ë¡ ì¶œë ¥
    - ì¶œë ¥ ê²°ê³¼ì— ìˆëŠ” device idë¥¼ ì´ìš©í•˜ì—¬ í•´ë‹¹ ê¸°ê¸°ì™€ ìƒí˜¸ì‘ìš© ê°€ëŠ¥
        
        ![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2032.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2032.png)
        

`frida -U -n "My Scan APP" -l frida_script.js`

- frida_script.js
    
    ```jsx
    Java.perform(function () {
        var TargetClass = Java.use('com.ldjSxw.heBbQd.a.b');
        TargetClass.k.implementation = function () {
            send("[+] Intercepted com.ldjSxw.heBbQd.a.b.k()");
            return false;
        };
    });
    ```
    

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2033.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2033.png)

Failed ëœ¬ ì´ìœ ëŠ” ì•±ì„ í•œë²ˆ ì‹¤í–‰ì‹œì¼œì•¼ í•œë‹¤.

ìŠ¤í¬ë¦½íŠ¸ ì£¼ì…í•´ì„œ í•œë²ˆì— ìë™ì‹¤í–‰

**`frida -U -l "bypass_script.js" -f "com.ldjSxw.heBbQd"`**

`frida-ps -Uai`

```python
#Fridaê°€ ì„¤ì¹˜ëœ Android ë””ë°”ì´ìŠ¤ì—ì„œ ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ ëª©ë¡ì„ í‘œì‹œ
frida-ps -Uai

```

Fridaê°€ ì„¤ì¹˜ëœ Android ë””ë°”ì´ìŠ¤ì—ì„œ ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ ëª©ë¡ì„ í‘œì‹œí•˜ëŠ” ëª…ë ¹ì–´ ì´ë‹¤.

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2034.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2034.png)

ìœ„ì˜ My Scan APPì´ ì‹¤í–‰ì¤‘ì¸ ê²ƒì„ í™•ì¸í•œë‹¤.

![2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2035.png](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Untitled%2035.png)

ë‹¤ì‹œ `frida -U -n "My Scan APP" -l frida_script.js` ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ë©´ ë¶™ëŠ”ë‹¤. 

ì´ì œ genymotionì—ì„œ `My Scan APP`ì•±ì„ ì‹¤í–‰í•˜ë©´ ëœë‹¤.

## 2.8 MobSF APIë¥¼ ì´ìš©í•œ ë¶„ì„ ìë™í™”

### ì •ì ë¶„ì„

```python
import subprocess
import os
import requests
from Cryptodome.Cipher import AES #crytoë‚˜ cryptographyë¡œë„ í•´ë´¤ìœ¼ë‚˜ ì›ë³¸-ë™ì  ë¬¸ì œëŠ” ê³„ì†
from Cryptodome.Util.Padding import unpad #íŒ¨ë”©ê³¼ì • ë„£ìœ¼ë©´ 38ì  ì•ˆí•˜ë©´ 28ì . ë‚®ì„ìˆ˜ë¡ critical riskë¼ì„œ ì†ì•˜ë‹¤. mobsf ì ìˆ˜ í‰ê°€ëŠ” ì·¨ì•½ì  ìˆ˜ë¡œ í•˜ëŠ”ê²Œ ì•„ë‹ˆë¼ ìƒ‰ê¹”ë³„ ë¹„ìœ¨ë¡œ í•˜ëŠ”ë“¯.
import glob
import time
import threading
import json

def decompile_apk(apk_path, output_dir):
    # APK íŒŒì¼ ë””ì»´íŒŒì¼
    try:
        subprocess.run(['C:\\Windows\\apktool.bat', 'd', '-r', '-s', '-f', apk_path, '-o', output_dir], input=b'\n', check=True)
        print(f"APK ë””ì»´íŒŒì¼ ì„±ê³µ: {apk_path}")
        return True
    except subprocess.CalledProcessError as e:
        print(f"APK ë””ì»´íŒŒì¼ ì‹¤íŒ¨: {e}")
        return False
    
def find_nested_apks_and_decompile(decompiled_dir):
    # ì¤‘ì²©ëœ APK ì°¾ê¸° ë° ë””ì»´íŒŒì¼
    for root, dirs, files in os.walk(decompiled_dir):
        for file in files:
            if file.endswith('.apk'):
                nested_apk_path = os.path.join(root, file)
                nested_decompiled_dir = nested_apk_path + '_decompiled'
                if decompile_apk(nested_apk_path, nested_decompiled_dir):
                    process_dex_files(nested_decompiled_dir)

# ë³µí˜¸í™” ìˆ˜í–‰
def decrypt_dex_file(encrypted_dex_path, decrypted_dex_path, aes_key):
    try:
        # encrypted dex file open
        with open(encrypted_dex_path, 'rb') as encrypted_file:
            encrypted_data = encrypted_file.read()
        
        # ë³µí˜¸í™”ê³¼ì •
        cipher = AES.new(aes_key, AES.MODE_ECB)
        
        decrypted_data = unpad(cipher.decrypt(encrypted_data), AES.block_size)
        
        with open(decrypted_dex_path, 'wb') as decrypted_file:
            decrypted_file.write(decrypted_data)
            
        print(f"Dex decrypted complete: {encrypted_dex_path} -> {decrypted_dex_path}")
    
        # ë³µí˜¸í™”í•œ ë””ì»´íŒŒì¼ ì‚­ì œ ì—¬ë¶€
        # os.remove(encrypted_dex_path)
        
        return True
    
    except Exception as e:
        print(f"Decrypting Error: {e}")
        return False

def process_dex_files(decompiled_dir):
    # 'kill'ë¡œ ì‹œì‘í•˜ëŠ” DEX íŒŒì¼ ì²˜ë¦¬
    dex_files = glob.glob(os.path.join(decompiled_dir, '*dex'))
    encrypted_dex = []
    for dex_file_path in dex_files:
        with open(dex_file_path, 'rb') as file:
            header = file.read(8)
            if not header.startswith(b'dex\n035'):
                encrypted_dex.append(dex_file_path)
    
    print(f'encrypted_dex: {encrypted_dex}')
    for encrypted_dex_path in encrypted_dex:
        new_dex_number = len([f for f in dex_files if os.path.basename(f).startswith('classes')]) + 1
        
        # ë³µí˜¸í™” í•œ dexíŒŒì¼ ê²½ë¡œ ë° ì´ë¦„ ì§€ì •
        decrypted_dex_path = os.path.join(decompiled_dir, f'classes{new_dex_number}.dex')
        decrypt_dex_file(encrypted_dex_path, decrypted_dex_path, aes_key)

        dex_files.append(decrypted_dex_path)

def recompile_apk(decompiled_dir, output_apk_path, keystore_path, keystore_password, key_alias):
    # ë””ì»´íŒŒì¼ëœ APK ì¬ì»´íŒŒì¼
    try:
        subprocess.run(['C:\\Windows\\apktool.bat', 'b', '-f', decompiled_dir, '-o', output_apk_path], input=b'\n', check=True)
        print(f"APK ì¬ì»´íŒŒì¼ ì„±ê³µ: {output_apk_path}")

        # APK ì¬ì„œëª…
        sign_cmd = [
            'jarsigner',
            '-verbose',
            '-sigalg', 'SHA256withRSA',  # ìƒˆë¡œìš´ í‚¤ìŠ¤í† ì–´ì— ë§ëŠ” ì„œëª… ì•Œê³ ë¦¬ì¦˜
            '-digestalg', 'SHA-256',  # ìƒˆë¡œìš´ í‚¤ìŠ¤í† ì–´ì— ë§ëŠ” ë‹¤ì´ì œìŠ¤íŠ¸ ì•Œê³ ë¦¬ì¦˜
            '-keystore', keystore_path,
            '-storepass', keystore_password,
            output_apk_path,
            key_alias
        ]
        subprocess.run(sign_cmd, check=True)
        print(f"APK ì„œëª… ì„±ê³µ: {output_apk_path}")

    except subprocess.CalledProcessError as e:
        print(f"APK ì¬ì»´íŒŒì¼ ë˜ëŠ” ì„œëª… ì‹¤íŒ¨: {e}")

class MobSF_API:
    def __init__(self, server, api_key, file_path):
        self.server = server
        self.api_key = api_key
        self.file_path = file_path

    def upload(self):
        print("íŒŒì¼ì„ MobSF ì„œë²„ì— ì—…ë¡œë“œ ì¤‘...")
        with open(self.file_path, 'rb') as f:
            files = {'file': (os.path.basename(self.file_path), f, 'application/octet-stream')}
            headers = {'Authorization': self.api_key}
            response = requests.post(f'{self.server}/api/v1/upload', files=files, headers=headers)
            result = response.json()
            if response.status_code == 200 and 'hash' in result:
                print("ì—…ë¡œë“œ ì„±ê³µ.")
                return result['hash']
            else:
                print("ì—…ë¡œë“œ ì‹¤íŒ¨.")
                return None

    def scan(self, file_hash):
        print("ì—…ë¡œë“œëœ íŒŒì¼ ìŠ¤ìº” ì‹œì‘...")
        data = {'hash': file_hash}
        headers = {'Authorization': self.api_key}
        response = requests.post(f'{self.server}/api/v1/scan', data=data, headers=headers)
        result = response.json()
        if response.status_code == 200:
            print("ìŠ¤ìº” ì„±ê³µì ìœ¼ë¡œ ì‹œì‘ë¨.")
            return result
        else:
            print("ìŠ¤ìº” ì‹œì‘ ì‹¤íŒ¨.")
            return None

    def download_pdf_report(self, file_hash):
        print("ìŠ¤ìº”ëœ íŒŒì¼ì˜ PDF ë³´ê³ ì„œ ë‹¤ìš´ë¡œë“œ ì¤‘...")
        data = {'hash': file_hash}
        headers = {'Authorization': self.api_key}
        response = requests.post(f'{self.server}/api/v1/download_pdf', data=data, headers=headers, stream=True)
        if response.status_code == 200:
            pdf_path = f'{os.path.splitext(self.file_path)[0]}_report.pdf'
            with open(pdf_path, 'wb') as f:
                for chunk in response.iter_content(chunk_size=1024):
                    if chunk:
                        f.write(chunk)
            print(f"PDF ë³´ê³ ì„œê°€ {pdf_path}ì— ì„±ê³µì ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œë¨.")
        else:
            print("PDF ë³´ê³ ì„œ ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨.")

```

### ë™ì ë¶„ì„

```python
    def get_APPS(self):
        headers = {'Authorization': self.api_key}
        response = requests.get(f'{self.server}/api/v1/dynamic/get_apps', headers=headers)
        result = response.json()

        if response.status_code == 200:
            identifier = result.get('identifier', '')
            print(f"Get APPS: {result}")
            return identifier
        else:
            print("Failed to Get APPS", response.status_code, result)
            
    def mobsfying(self, identifier):
        """API to MobSFY android environmnet"""
        headers = {'Authorization': self.api_key}
        data = {'identifier': identifier}    
        response = requests.post(f'{self.server}/api/v1/android/mobsfy', headers=headers, data=data)
        if response.status_code == 200:
            print("mobsfy: ", response.json())
        else:
            print("mobsfy Error: ", response.status_code, response.json())
            

    def start_dynamic_analysis(self, file_hash):
        """ë™ì  ë¶„ì„ ì‹œì‘"""
        print("ë™ì  ë¶„ì„ ì‹œì‘ ì¤‘...")
        data = {'hash': file_hash}
        headers = {'Authorization': self.api_key}
        response = requests.post(f'{self.server}/api/v1/dynamic/start_analysis', data=data, headers=headers)
        result = response.json()
        if response.status_code == 200:
            print("ë™ì  ë¶„ì„ì´ ì„±ê³µì ìœ¼ë¡œ ì‹œì‘ë¨.")
            return result
        else:
            print("ë™ì  ë¶„ì„ ì‹œì‘ ì‹¤íŒ¨.")
            return None

    def bypass_anti_vm(self, package_name, bypass_script_path):
        """ì•ˆí‹° VMì„ ìš°íšŒí•˜ê¸° ìœ„í•´ Frida ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰. ìŠ¤í¬ë¦½íŠ¸ëŠ” ì§€ì†ì ìœ¼ë¡œ ì‹¤í–‰ë˜ì–´ì•¼ í•¨."""
        def run_script():
            print("ì•ˆí‹° VM ìš°íšŒë¥¼ ìœ„í•´ Frida ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì¤‘...")
            self.process = subprocess.Popen(['frida', '-U', '-l', bypass_script_path, '-f', package_name],
                                             stdout=subprocess.PIPE, stderr=subprocess.PIPE)
            print(f"{package_name}ì— ëŒ€í•œ ì•ˆí‹° VM ìš°íšŒ ì‹œì‘ë¨.")
        
        self.frida_thread = threading.Thread(target=run_script)
        self.frida_thread.start()

    def tls_test(self, file_hash):
        """SSL/TLS TESTER"""
        print("SSL/TLS TEST STARTING...")
        headers = {'Authorization': self.api_key}
        data = {'hash': file_hash}
        try:
            response = requests.post(f'{self.server}/api/v1/android/tls_tests', headers=headers, data=data)
            if response.status_code == 200:
                print("SSL/TLS Success: ", response.json())
            else:
                print("SSL/TLS Error: ", response.status_code, response.json())
        except requests.exceptions.RequestException as e:
            print("HTTP Request Failed: ", e)
        except json.decoder.JSONDecodeError:
            print("JSON decoding failed")
            
    # ìš´ì§€ë‹˜ ssl tls test
    # def dynamic_tls_ssl_test(self, file_hash): #ì´ê²ƒë„ ë¹„ë™ê¸° ë°±ê·¸ë¼ìš´ë“œë¡œ
    #     """TLS/SSL ë³´ì•ˆ í…ŒìŠ¤íŠ¸ë¥¼ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ìˆ˜í–‰í•˜ê³  ê²°ê³¼ë¥¼ ì¶œë ¥"""

    #     def run_test():
    #         if not file_hash:
    #             print("íŒŒì¼ í•´ì‹œê°€ ì œê³µë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.")
    #             return

    #         print("TLS/SSL ë³´ì•ˆ í…ŒìŠ¤íŠ¸ ìˆ˜í–‰ ì¤‘...")
    #         headers = {'Authorization': self.api_key}
    #         data = {'hash': file_hash}
    #         response = requests.post(f'{self.server}/api/v1/android/tls_tests', data=data, headers=headers)

    #         if response.status_code == 200:
    #             print("TLS/SSL ë³´ì•ˆ í…ŒìŠ¤íŠ¸ê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.")
    #             results = response.json()
    #             print(json.dumps(results, indent=4))
    #         else:
    #             print("TLS/SSL ë³´ì•ˆ í…ŒìŠ¤íŠ¸ ìˆ˜í–‰ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")

    #     # ë°±ê·¸ë¼ìš´ë“œ ìŠ¤ë ˆë“œì—ì„œ TLS/SSL ë³´ì•ˆ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
    #     test_thread = threading.Thread(target=run_test)
    #     test_thread.start()

    def start_activity_analysis(self, file_hash, activity_name):
        """ì•±ì˜ íŠ¹ì • activityì— ëŒ€í•œ ë™ì  ë¶„ì„ ì‹œì‘."""
        print(f"{activity_name} ë™ì  ë¶„ì„ ì‹œì‘ ì¤‘...")
        data = {'hash': file_hash, 'activity': activity_name}
        headers = {'Authorization': self.api_key}
        response = requests.post(f'{self.server}/api/v1/android/start_activity', data=data, headers=headers)
        if response.status_code == 200:
            print(f"{activity_name} ë™ì  ë¶„ì„ì´ ì„±ê³µì ìœ¼ë¡œ ì‹œì‘ë¨.")
            return response.json()
        else:
            print(f"{activity_name} ë™ì  ë¶„ì„ ì‹œì‘ ì‹¤íŒ¨.")
            return None

    def tap_screen(self, x, y):
        """í™”ë©´ì˜ íŠ¹ì • ìœ„ì¹˜ë¥¼ íƒ­í•˜ëŠ” ADB ëª…ë ¹ì–´ ì‹¤í–‰"""
        adb_cmd = f'adb shell input tap {x} {y}'
        try:
            subprocess.run(adb_cmd, shell=True, check=True)
            print(f"í™”ë©´ ìœ„ì¹˜ ({x}, {y}) íƒ­ ì„±ê³µ")
        except subprocess.CalledProcessError as e:
            print(f"í™”ë©´ ìœ„ì¹˜ ({x}, {y}) íƒ­ ì‹¤íŒ¨: {e}")

    def scroll_down(self, start_x, start_y, end_x, end_y):
        cmd = f"adb shell input swipe {start_x} {start_y} {end_x} {end_y}"
        try:
            subprocess.run(cmd.split(), stdout=subprocess.PIPE, stderr=subprocess.PIPE)
            print(f"í™”ë©´ ìŠ¤í¬ë¡¤ ë‹¤ìš´ ì„±ê³µ: {start_x}, {start_y} -> {end_x}, {end_y}")
        except subprocess.CalledProcessError as e:
            print(f"í™”ë©´ ìŠ¤í¬ë¡¤ ë‹¤ìš´ ì‹¤íŒ¨: {e}")        
    
    def stop_frida_script(self):
        """Frida ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì¢…ë£Œí•©ë‹ˆë‹¤."""
        if self.process:
            self.process.terminate()
            self.process = None
            print("Frida ìŠ¤í¬ë¦½íŠ¸ ì¢…ë£Œë¨.")    
            
    # def get_dynamic_analysis_status(self, file_hash):
    #     """ë™ì  ë¶„ì„ ìƒíƒœ í™•ì¸"""
    #     print("ë™ì  ë¶„ì„ ìƒíƒœ í™•ì¸ ì¤‘...")
    #     headers = {'Authorization': self.api_key}
    #     response = requests.get(f'{self.server}/api/v1/dynamic/status', headers=headers, params={'hash': file_hash})
    #     result = response.json()
    #     if response.status_code == 200:
    #         print("ë™ì  ë¶„ì„ ìƒíƒœ: ", result['status'])
    #         print("ë™ì  ë¶„ì„ ê²°ê³¼", result)
    #         return result
    #     else:
    #         print("ë™ì  ë¶„ì„ ìƒíƒœ í™•ì¸ ì‹¤íŒ¨.")
    #         return None
        
    def stop_dynamic_analysis(self, file_hash):
        """ë™ì  ë¶„ì„ì„ ë©ˆì¶”ê³  í•„ìš”í•œ ì •ë¦¬ ì‘ì—…ì„ ìˆ˜í–‰"""
        print("ë™ì  ë¶„ì„ì„ ë©ˆì¶”ëŠ” ì¤‘...")
        data = {'hash': file_hash}
        headers = {'Authorization': self.api_key}
        response = requests.post(f'{self.server}/api/v1/dynamic/stop_analysis', data=data, headers=headers)
        if response.status_code == 200:
            print("ë™ì  ë¶„ì„ì´ ì„±ê³µì ìœ¼ë¡œ ë©ˆì¶°ì§.")
        else:
            print("ë™ì  ë¶„ì„ì„ ë©ˆì¶”ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì‘ë‹µ ì½”ë“œ:", response.status_code)
    

    def download_dynamic_report(self, file_hash):
        """ë™ì  ë¶„ì„ ë¦¬í¬íŠ¸ ë‹¤ìš´ë¡œë“œ"""
        print("ë™ì  ë¶„ì„ ë¦¬í¬íŠ¸ ë‹¤ìš´ë¡œë“œ ì¤‘...")
        headers = {'Authorization': self.api_key}
        data = {'hash': file_hash}
        # ë™ì  ë¶„ì„ ë¦¬í¬íŠ¸ ë‹¤ìš´ë¡œë“œë¥¼ ìœ„í•œ ì—”ë“œí¬ì¸íŠ¸: /api/v1/dynamic/report_json
        response = requests.post(f'{self.server}/api/v1/dynamic/report_json', headers=headers, data=data)
        if response.status_code == 200:
            report_path = f'{os.path.splitext(self.file_path)[0]}_dynamic_report.json'
            with open(report_path, 'wb') as f:
                f.write(response.content)
            print(f"ë™ì  ë¶„ì„ ë¦¬í¬íŠ¸ê°€ {report_path}ì— ì„±ê³µì ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œë¨.")
        else:
            print("ë™ì  ë¶„ì„ ë¦¬í¬íŠ¸ ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨.")

if __name__ == "__main__":
    server_url = 'http://127.0.0.1:8000'  # MobSF ì„œë²„ URL
    api_key = '9eca7005f71ab259f2f7b0a51c672e381b7949180474b6382769296ddaf560d5'
    apk_path = 'C:\\Users\\faton\\Downloads\\test\\sandbox\\sample.apk'
    aes_key = b'dbcdcfghijklmaop'
    decompiled_dir = 'C:\\Users\\faton\\Downloads\\test\\sandbox\\decompiled_apk'
    output_dir = 'C:\\Users\\faton\\Downloads\\test\\sandbox'
    nested_decompiled_dir = 'C:\\Users\\faton\\Downloads\\test\\sandbox\\decompiled_apk\\assets\\pgsHZz.apk_decompiled'
    
    keystore_path = 'C:\\Users\\faton\\Downloads\\test\\sandbox\\honghong.keystore'  # í‚¤ìŠ¤í† ì–´ íŒŒì¼ ê²½ë¡œ
    keystore_password = "honghong"  # Keystore ë¹„ë°€ë²ˆí˜¸
    key_alias = 'honghong'  # í‚¤ ë³„ì¹­

    bypass_script_path = 'C:\\Users\\faton\\Downloads\\test\\sandbox\\bypass_vm_detection.js'
    package_name = 'com.ldjSxw.heBbQd'

    # APK ë””ì»´íŒŒì¼, ì¤‘ì²©ëœ APK ì²˜ë¦¬, DEX íŒŒì¼ ë³µí˜¸í™”
    decompile_apk(apk_path, decompiled_dir)
    find_nested_apks_and_decompile(decompiled_dir)
    process_dex_files(decompiled_dir)

    # APK ì¬ì»´íŒŒì¼ ë° ì„œëª…
    recompiled_apk_path = os.path.join(output_dir, 're_sample.apk')
    recompile_apk(decompiled_dir, recompiled_apk_path, keystore_path, keystore_password, key_alias)
    re_nested_apk_path = os.path.join(output_dir, 're_pgsHZz.apk')
    recompile_apk(nested_decompiled_dir, re_nested_apk_path, keystore_path, keystore_password, key_alias)
    
    # MobSF ì‘ì—… ì‹œì‘
    mobSF = MobSF_API(server_url, api_key, recompiled_apk_path)
    file_hash = mobSF.upload()
    mobSF_nested = MobSF_API(server_url, api_key, re_nested_apk_path)
    nested_file_hash = mobSF_nested.upload()

    if nested_file_hash:
        # ìŠ¤ìº” ë° PDF ë¦¬í¬íŠ¸ ë‹¤ìš´ë¡œë“œ
        mobSF_nested.scan(nested_file_hash)
        mobSF_nested.download_pdf_report(nested_file_hash)

    if file_hash:
        # ìŠ¤ìº”, PDF ë¦¬í¬íŠ¸ ë‹¤ìš´ë¡œë“œ
        mobSF.scan(file_hash)
        mobSF.download_pdf_report(file_hash)

        # ë™ì  ë¶„ì„ ì‹œì‘
        identifier = mobSF.get_APPS()
        mobSF.mobsfying(identifier)
        dynamic_results = mobSF.start_dynamic_analysis(file_hash)
        mobSF.tls_test(file_hash)
        
        if dynamic_results:
            mobSF.bypass_anti_vm(package_name, bypass_script_path)
            time.sleep(30)

            mobSF.start_activity_analysis(file_hash, 'com.ldjSxw.heBbQd.IntroActivity')
            # ë™ì  ë¶„ì„ ì¤‘ TLS/SSL ë³´ì•ˆ í…ŒìŠ¤íŠ¸ ìˆ˜í–‰
            # mobSF.dynamic_tls_ssl_test(file_hash) #ë¹„ë™ê¸° ë°±ê·¸ë¼ìš´ë“œë¡œ í•´ë´¤ìœ¼ë‚˜ ì–˜ë„ ì•±ì„ ì‹¤í–‰ì‹œí‚¤ëŠ”ë“¯. í”„ë¦¬ë‹¤ ìš°íšŒ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë¶™ì—¬ì•¼í•˜ê³ , ìˆœì„œê°€ ì¤‘ìš”
            mobSF.start_activity_analysis(file_hash, 'com.ldjSxw.heBbQd.MainActivity')
            mobSF.start_activity_analysis(file_hash, 'com.ldjSxw.heBbQd.ScanActivity')
            mobSF.start_activity_analysis(file_hash, 'com.ldjSxw.heBbQd.ResultActivity')

            mobSF.tap_screen(273, 698)#ì¹˜ë£Œí•˜ê¸°
            time.sleep(5)

            mobSF.tap_screen(434, 541)#ì˜ˆ
            time.sleep(5)

            mobSF.tap_screen(473, 844)#install
            time.sleep(9)
            
            mobSF.tap_screen(381, 841)#done
            time.sleep(5)

            mobSF.tap_screen(268, 926)#home
            time.sleep(5)

            mobSF.tap_screen(335, 610)# settings
            time.sleep(15)

            mobSF.scroll_down(329, 881, 358, 87)
            time.sleep(3)
            mobSF.scroll_down(329, 881, 358, 87)
            time.sleep(3)
            mobSF.scroll_down(329, 881, 358, 87)
            time.sleep(3)
            mobSF.scroll_down(329, 881, 358, 87)
            time.sleep(3)

            mobSF.tap_screen(177, 515)# accessbility
            time.sleep(5)

            mobSF.tap_screen(90, 242)# sonqLgOT
            time.sleep(5)

            mobSF.tap_screen(464, 159)# sonqLgOT
            time.sleep(5)

            mobSF.tap_screen(434, 814)# ok
            time.sleep(5)

            mobSF.tap_screen(418, 920)# ã…
            time.sleep(5)

            mobSF.tap_screen(298, 168)# ìƒˆì°½
            time.sleep(5)

            mobSF.tap_screen(279, 721)# ê²€ì‚¬ì‹œì‘
            time.sleep(10)

            mobSF.tap_screen(287, 699)# ì¹˜ë£Œí•˜ê¸°
            time.sleep(5)

            mobSF.stop_frida_script()

            # ë™ì  ë¶„ì„ ë©ˆì¶¤
            mobSF.stop_dynamic_analysis(file_hash)
                                

            # ë™ì  ë¶„ì„ ë¦¬í¬íŠ¸ ë‹¤ìš´ë¡œë“œ
            mobSF.download_dynamic_report(file_hash)

```

## 2.9 ìµœì¢… ê²°ê³¼

### 2.9.1 ì†ŒìŠ¤ì½”ë“œ ì••ì¶•íŒŒì¼

[mobsfAPI.py](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/mobsfAPI.py)

[2024_mobile_3íšŒì°¨_2ì¡°_í•´ì»¤ì¡ì¡°.zip](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/2024_mobile_3%25ED%259A%258C%25EC%25B0%25A8_2%25EC%25A1%25B0_%25ED%2595%25B4%25EC%25BB%25A4%25EC%259E%25A1%25EC%25A1%25B0.zip)

### 2.9.2 ì‹œì—° ë™ì˜ìƒ

MobSF ì»¤ìŠ¤í…€ APIë¡œ ìë™í™” / ì—…ë¡œë“œ - ì •ì ë¶„ì„ - ë™ì ë¶„ì„ -  ê²°ê³¼ë¬¼

[final4.mp4](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/final4.mp4)

+Virustotal_APIë¡œ ì•…ì„±ì½”ë“œ íŒ¨ë°€ë¦¬ ì‹ë³„

[Identifying Malicious Code Families.mp4](2%E1%84%8E%E1%85%A1%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%87%E1%85%A9%E1%84%80%E1%85%A9%E1%84%89%E1%85%A5%2013fe76967e094e9c8ad95e6bd9d96f26/Identifying_Malicious_Code_Families.mp4)

# 3. íšŒê³ 

## í”„ë¡œì íŠ¸ ìì²´ í‰ê°€ ë° ëŠë‚€ ì 

### í™ì˜ì°½

---

íŒ€ì¥ìœ¼ë¡œì„œ í”„ë¡œì íŠ¸ì— ëŒ€í•œ ì´í•´ë¥¼ ë¹¨ë¦¬í•˜ê³  ë°©í–¥ì„ ì¡ì•„ì•¼ í–ˆì§€ë§Œ í”„ë¡œì íŠ¸ì— ëŒ€í•œ ê²½í—˜ê³¼ ì´í•´ê°€ ë¶€ì¡±í•˜ì—¬ ì–´ë–»ê²Œ ì§„í–‰í•´ì•¼ ë ì§€ ë§‰ë§‰í–ˆìœ¼ë‚˜, ë©˜í† ë‹˜ì˜ ì§ˆì˜ì‘ë‹µ ì‹œê°„ì„ í†µí•´ ëª©í‘œì™€ ë°©í–¥ì„±ì„ ì¡ê³  ì¡°ê¸ˆì”© ì§„í–‰í•´ ë‚˜ê°”ë‹¤.
ìœˆë„ìš° ì‹¤í–‰íŒŒì¼ ì•…ì„±ì½”ë“œ ë¶„ì„ì€ í•´ë³¸ ê²½í—˜ì´ ìˆì§€ë§Œ ì•ˆë“œë¡œì´ë“œ ì•…ì„±ì½”ë“œ ì•± ë¶„ì„ì€ ê²½í—˜ì´ ì—†ì–´ì„œ ì•ˆë“œë¡œì´ë“œ ì•„í‚¤í…ì²˜ì— ëŒ€í•œ ê°œë…ê³¼ íŒŒì¼ êµ¬ì¡°ì— ëŒ€í•´ ê³µë¶€í•´ì•¼ í–ˆë‹¤. ê·¸ë¦¬ê³  jadx ë¶„ì„ë„êµ¬ë¥¼ í†µí•´ ì•± ë™ì‘ ê³¼ì •ì„ 100% ì´í•´í•  ìˆ˜ ì—†ì—ˆì§€ë§Œ ì–´ëŠ ì •ë„ëŠ” ì´í•´í•  ìˆ˜ ìˆì–´ì„œ ì¬ë°Œì—ˆê³  ê¸°ì¡´ì—ëŠ” cì–¸ì–´ì™€ pythonì–¸ì–´ ê³µë¶€ë¥¼ í•´ì™”ì—ˆë‹¤ë©´ DEX íŒŒì¼ì„ ë¶„ì„í•˜ë©´ì„œ APKëŠ” ë””ì»´íŒŒì¼ì‹œ Javaì†ŒìŠ¤ì½”ë“œë¡œ ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— Javaì–¸ì–´ì— ëŒ€í•œ ê³µë¶€ í•„ìš”ì„±ë„ ëŠë¼ê²Œ ë˜ì—ˆë‹¤.
ë‚´ë¶€ Nested apkê°€ í•µì‹¬ì ìœ¼ë¡œ ë™ì‘í•˜ëŠ” ì•…ì„±ì½”ë“œì—¬ì„œ ë‚˜ì¤‘ì— ì´ ë¶€ë¶„ë„ ì¶”ê°€ë¡œ ê³µë¶€í•´ì„œ ë™ì‘ê³¼ì •ì„ ì´í•´í•˜ê³  ì‹¶ë‹¤.
ë˜ MobSF apië¥¼ í†µí•œ ì „ ìë™í™” ê³¼ì •ì„ ì§ì ‘ ë§Œë“¤ì–´ë³´ì§„ ëª»í–ˆì§€ë§Œ ê²½í—˜í•´ ë´„ìœ¼ë¡œì¨ apiì— ê´€í•œ ê³µë¶€ë„ í•  ìˆ˜ ìˆì–´ì„œ ì¢‹ì•˜ë‹¤.

### êµ¬í˜„ëª¨

---

ì•± ê´€ë ¨í•˜ì—¬ ê°„ë‹¨í•œ ì§€ì‹ ë°–ì— ì—†ì—ˆëŠ”ë° ì´ë²ˆ ê³„ê¸°ë¥¼ í†µí•´ ì•± êµ¬ì¡° ë° ì•” ë³µí˜¸í™”, ì„œëª… ë“± ê°œë…ì„ ë°°ì› ë‹¤.

ì§„í–‰í•˜ë©´ì„œ ì˜¤ë¥˜ê°€ ë§ì•˜ëŠ”ë° íŒ€ì›ë“¤ì—ê²Œ ë„ì›€ì„ ë°›ì•„ í•´ê²°í•´ë‚˜ê°€ë©´ì„œ ê°ì‚¬í•¨ì„ ë§ì´ ëŠê¼ˆë‹¤â€¦

ì‘ì—… í›„ë°˜ìœ¼ë¡œ ê°ˆìˆ˜ë¡ ë„ì›€ì´ ë˜ì§€ ëª»í•´ ì•„ì‰¬ì› ê³  ê°œì¸ì ìœ¼ë¡œ ë¶€ì¡±í•œ ì—­ëŸ‰ì„ í‚¤ì›Œì•¼ê² ë‹¤ëŠ” ìƒê°ì´ ë§ì´ ë“¤ê³¤ í–ˆë‹¤.

ë‹¤ìŒ í”„ë¡œì íŠ¸ ë•ŒëŠ” ë” ì—´ì‹¬íˆ í•´ì„œ íŒ€ì›ë“¤ì—ê²Œ ë„ì›€ì´ ë˜ë„ë¡ ë…¸ë ¥í•´ì•¼ê² ë‹¤.

### ê¹€ë™ì§„

---

ì•…ì„± ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ë¶„ì„ì„ MobSFë¥¼ í™œìš©í•˜ì—¬ ì •ì  ë¶„ì„ ë° ë™ì  ë¶„ì„ì„ í•´ë³´ë©´ì„œ apk íŒŒì¼ êµ¬ì¡°ì™€ apkê°€ ì‹¤í–‰íŒŒì¼ì´ ë˜ëŠ” ê³¼ì •ì„ ë°°ìš¸ ìˆ˜ ìˆì—ˆë‹¤. ì•…ì„± ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ ì–´ë–¤ ì‹ìœ¼ë¡œ ì‚¬ìš©ìë¥¼ ì†ì´ê³  ì„¤ì¹˜ ë° ì‹¤í–‰ë˜ëŠ”ì§€ë„ ê²½í—˜í•  ìˆ˜ ìˆì—ˆë‹¤. ì•…ì„± ì–´í”Œë¦¬ì¼€ì´ì…˜ ë¶„ì„ì„ ìœ„í•œ ìƒŒë“œë°•ìŠ¤ êµ¬ì¶•ì— ì‹œê°„ì„ ë§ì´ ì“°ê±°ë‚˜ ê²½í—˜ì´ ì—†ì–´ ì²˜ìŒì— ê°ì„ ë¹¨ë¦¬ ì¡ì§€ ëª»í•˜ì—¬ ì‹œê°„ì„ ë§ì´ ë³´ë‚¸ê²Œ ì•„ì‰¬ì› ë‹¤. APIë¥¼ í™œìš©í•œ ìë™í™”ë¥¼ í•˜ë©´ì„œ ìƒê°ë³´ë‹¤ ë§ì´ ì–´ë ¤ì› ëŠ”ë° íŒ€ì›ë“¤ì´ ë§ì´ ë„ì™€ì¤˜ì„œ ì˜ ì§„í–‰ë˜ì—ˆë‹¤. 

### ì¥ë‹¤ì†œ

---

ì´ë²ˆ í”„ë¡œì íŠ¸ë¥¼ í†µí•´ ì •ì ë¶„ì„ê³¼ ë™ì ë¶„ì„ì„ í†µí•œ APK íŒŒì¼ì˜ êµ¬ì¡°ì™€ ë¶„ì„ ë°©ë²•ì— ëŒ€í•œ ì†Œì¤‘í•œ ê²½í—˜ì„ ìŒ“ì„ ìˆ˜ ìˆì—ˆë‹¤. 

ì• í”Œë¦¬ì¼€ì´ì…˜ ë³´ì•ˆì— ëŒ€í•œ ì·¨ì•½ì ê³¼ ê²½ê°ì‹¬ì„ ëŠê¼ˆìœ¼ë©°, í™˜ê²½ êµ¬ì¶•ê³¼ ì—°ë™ì˜ ì–´ë ¤ì›€ì„ ê²ªì„ ë•Œë§ˆë‹¤ íŒ€ì›ë“¤ì˜ ë„ì›€ìœ¼ë¡œ ë§¤ë„ëŸ½ê²Œ ì§„í–‰ë  ìˆ˜ ìˆì—ˆë‹¤. í•˜ì§€ë§Œ ìë™í™” ì†ŒìŠ¤ì½”ë“œì™€ ì—ëŸ¬ ìˆ˜ì • ë¶€ë¶„ì—ì„œ ë„ì›€ì´ ë˜ì§€ ëª»í•´ ì•„ì‰¬ì› ë‹¤. 

ì´ë¥¼ í†µí•´ íŒ€ì›ê³¼ì˜ ì†Œí†µê³¼ í˜‘ë ¥ì˜ ì¤‘ìš”ì„±ì„ í•œ ë²ˆ ë” ê¹¨ë‹¬ì•˜ë‹¤.

### ì¡°ìš´ì§€

---

ì•…ì„±ì½”ë“œ ë¶„ì„ì„ ì œëŒ€ë¡œ ëª»í•´ë´ì„œ ì•„ì‰½ê¸´ í–ˆì§€ë§Œ, ì•ˆë“œë¡œì´ë“œì™€ ì—ë®¬ì— ëŒ€í•œ ì´í•´ë„ê°€ ìƒê²¼ê³  íŠ¹íˆ mobsf APIìë™í™”ë¥¼ ì½”ë”©í•˜ëŠ” ê³¼ì •ì—ì„œ í”„ë¡œê·¸ë˜ë°ì— ëŒ€í•œ ì¬ë¯¸ë¥¼ ëŠë¼ê²Œ ë˜ì–´ì„œ ê°œì¸ì ìœ¼ë¡œ ì˜ë¯¸ ìˆëŠ” í”„ë¡œì íŠ¸ì˜€ë‹¤. 

ì¶”ê°€ì ìœ¼ë¡œ ì•…ì„±ì½”ë“œ íŒ¨ë°€ë¦¬ ì‹ë³„ì„ Virustotal APIë¡œ í•´ë³´ë©´ ì–´ë–¨ê¹Œí•˜ëŠ” ì•„ì´ë””ì–´ê°€ ë– ì˜¬ë¼ì„œ ê·¸ëƒ¥ ì¬ë¯¸ë¡œ ì‹œë„í•´ë³´ì•˜ëŠ”ë°, ì§§ì€ ì‹œê°„ ì•ˆì— ê²°ê³¼ë¬¼ì„ ë§Œë“¤ì–´ì„œ ìŠ¤ìŠ¤ë¡œë„ ë†€ë¬ë‹¤.

ì €ë²ˆ í¬íŠ¸ìŠ¤ìºë„ˆ í”„ë¡œì íŠ¸ë³´ë‹¤ ë” ë‚¯ì„¤ì—ˆë˜ í”„ë¡œì íŠ¸ì˜€ëŠ”ë° ì–»ì–´ê°€ëŠ”ê²Œ ë§ì•„ì„œ êµ¬ì„±ì„ ì˜í•´ì£¼ì‹  ë©˜í† ë‹˜ê»˜ ê°ì‚¬í•˜ë‹¤ëŠ” ë§ì„ ì „í•˜ê³  ì‹¶ë‹¤.

### ìµœìŠ¹í¬

---

ì–´í”Œë¦¬ì¼€ì´ì…˜ì€ ì²˜ìŒ ë‹¤ë¤„ë´ì„œ ë‚¯ì„¤ì—ˆì§€ë§Œ ìƒ‰ë‹¤ë¥¸ ëŠë‚Œì´ì–´ì„œ ì¬ë°Œì—ˆë‹¤. mobsf êµ¬ì¡° ë¶„ì„, sample.apk, dexíŒŒì¼ ë¶„ì„ ëª¨ë‘ ëŒ€ëµì ìœ¼ë¡œ í•´ë³´ì•˜ëŠ”ë° ì²˜ìŒì—ëŠ” ë„ˆë¬´ ë‚œí•´í–ˆì§€ë§Œ ë³´ë‹¤ë³´ë‹ˆê¹Œ ì´í•´ê°€ ê°€ë©´ì„œ ì¦ê±°ì›€ì„ ëŠê¼ˆë‹¤. ë¶„ì„ ê³¼ì •ì—ì„œ ê°€ì¥ í° ì¬ë¯¸ë¥¼ ëŠê¼ˆì—ˆë˜ ê²ƒ ê°™ë‹¤. ì´í›„ì— ì´í•´í•œ ê²ƒì„ ë°”íƒ•ìœ¼ë¡œ ì½”ë“œë¥¼ êµ¬í˜„í•˜ëŠ”ë° ì–´ë ¤ì›€ì„ ëŠê¼ˆì§€ë§Œ ë‹¤ë¥¸ íŒ€ì›ë“¤ê³¼ í•¨ê»˜í•˜ë©° í•˜ë‚˜ì”© ëŒíŒŒí•´ë‚˜ê°€ëŠ” ì¬ë¯¸ë„ ìˆì—ˆë‹¤. ì´ë²ˆ í”„ë¡œì íŠ¸ëŠ” í•˜ë‚˜í•˜ë‚˜ ì´í•´í•˜ë©´ì„œ í•´ë‚¸ ëŠë‚Œì´ë¼ ì˜ë¯¸ìˆëŠ” ê²ƒ ê°™ë‹¤.

# 4. ì°¸ê³ ë¬¸í—Œ

---

[ANDITERë¥¼ í™œìš©í•œ ì•ˆë“œë¡œì´ë“œ ìœ„í˜‘ íƒì§€ ë° ìš°íšŒ ë°©ì•ˆ : PART 3 (í”„ë¦¬ë‹¤, í”¼ë‹)](https://www.igloo.co.kr/security-information/anditerë¥¼-í™œìš©í•œ-ì•ˆë“œë¡œì´ë“œ-ìœ„í˜‘-íƒì§€-ë°-ìš°íšŒ-ë°©ì•ˆ-part-3-í”„/)

â‡’ frida ìš°íšŒ ë°©ë²•

[[Android] APK íŒŒì¼ ë¦¬íŒ¨í‚¤ì§•(repackaging)í•˜ëŠ” ë°©ë²•](https://domdom.tistory.com/287)

â‡’ ì„œëª… ë°©ë²•

[](https://mobsf.live/api_docs)

â‡’ API Docs